
# クソサイト・スカウター 仕様・設計書

## プロジェクト概要

企業のウェブサイト品質を分析し、ビジネスチャンスを発見するためのWebアプリケーション。複数の無料データソースから企業情報を取得・統合し、ウェブサイトの品質分析を行う。

## 技術スタック

- **フロントエンド**: React 18, TypeScript, Vite
- **UIライブラリ**: shadcn-ui, Tailwind CSS
- **バックエンド**: Supabase（認証・データベース）
- **状態管理**: TanStack React Query
- **チャート**: Recharts
- **ルーティング**: React Router DOM

## 主要機能

### 1. 企業データ取得・管理

#### 1.1 データソース統合
- **国税庁法人番号公表サイト**: 日本の全法人基本情報
- **FUMA（フーマ）**: 160万社以上の企業情報
- **BIZMAPS**: 高鮮度な企業データ
- **Musubu（ムスブ）**: 無料プランで30件まで
- **Ullet（ユーレット）**: 上場企業の決算・財務データ
- **Yahoo!ファイナンス**: 上場企業の株価・財務諸表
- **商工会議所**: 地域別企業情報
- **GitHub Organizations**: ソフトウェア企業情報

#### 1.2 企業情報データ構造
```typescript
interface CorporateInfo {
  source: string;           // データソース名
  corporateNumber?: string; // 法人番号
  name: string;            // 企業名
  address?: string;        // 住所
  prefecture?: string;     // 都道府県
  industry?: string;       // 業界
  capital?: string;        // 資本金
  employees?: string;      // 従業員数
  website?: string;        // ウェブサイトURL
  phone?: string;          // 電話番号
  establishedDate?: string; // 設立日
  isListed?: boolean;      // 上場フラグ
}
```

#### 1.3 ビジネスデータ構造
```typescript
interface Business {
  id: string;
  name: string;
  website_url: string;
  has_website: boolean;
  location: string;
  industry: string;
  phone: string;
  address: string;
  data_source: string;
  overall_score: number;
  technical_score: number;
  eeat_score: number;
  content_score: number;
  ai_content_score: number;
  is_new: boolean;
  created_at: string;
  updated_at: string;
}
```

### 2. ウェブサイト品質分析

#### 2.1 分析項目
- **全体スコア**: 総合的な品質評価（0-5点）
- **技術スコア**: ページ速度、SSL証明書、レスポンシブ対応等
- **E-E-A-Tスコア**: 専門性、権威性、信頼性評価
- **コンテンツスコア**: 内容の質、更新頻度等
- **AIコンテンツスコア**: AI生成コンテンツの検出・評価

#### 2.2 分析結果の活用
- ビジネスチャンス発見（低品質サイト・サイト未保有企業）
- 競合分析・業界比較
- 営業提案書の自動生成
- 地域別・業界別統計分析

### 3. ダッシュボード・分析機能

#### 3.1 統計概要
- 総企業数、サイト保有率
- 平均品質スコア、ビジネスチャンス率
- 品質分布（低・中・高品質、サイトなし）
- 業界別分布

#### 3.2 分析チャート
- スコア分布チャート（ヒストグラム）
- 業界別平均スコア（横棒グラフ）
- スコア推移（時系列チャート）
- 都道府県別分析（日本地図可視化）

#### 3.3 フィルタリング機能
- 都道府県・地域フィルタ
- 業界フィルタ
- 企業規模フィルタ
- スコア範囲フィルタ
- ウェブサイト有無フィルタ

### 4. レポート・提案機能

#### 4.1 営業提案書生成
- 企業分析結果の自動要約
- 改善提案の生成
- カスタマイズ可能なテンプレート
- PDF/画像エクスポート

#### 4.2 競合比較分析
- 同業界他社との比較
- ベンチマーク分析
- 改善余地の特定

## データフロー設計

### 1. データ取得フロー
```
1. ユーザーがデータ取得を開始
2. 複数データソースから並行取得
3. データ正規化・統合
4. Supabaseデータベースに保存
5. 品質分析の実行
6. 結果のキャッシュ・表示
```

### 2. エラーハンドリング
- **データソースエラー**: エラーデータは無視、他ソースで補完
- **API制限**: フォールバックデータの生成
- **ネットワークエラー**: リトライ機能
- **データ形式エラー**: スキーマ検証・サニタイズ

### 3. パフォーマンス最適化
- **バックグラウンド処理**: 長時間データ取得の非同期実行
- **プログレス表示**: リアルタイム進捗更新
- **データキャッシュ**: React Queryによるクライアントサイドキャッシュ
- **ページネーション**: 大量データの分割表示

## セキュリティ設計

### 1. 認証・認可
- Supabase Authによるユーザー認証
- Row Level Security (RLS) によるデータアクセス制御
- ロールベースアクセス制御（user/admin）

### 2. データ保護
- SSL/TLS通信の強制
- APIキーの環境変数管理
- 入力データのサニタイズ
- SQLインジェクション対策

## 拡張性設計

### 1. 新データソース追加
```typescript
interface CorporateDataSource {
  name: string;
  url: string;
  description: string;
  type: 'api' | 'scrape' | 'csv';
  enabled: boolean;
  priority: number;
  maxRecords: number;
}
```

### 2. 分析指標追加
- プラグイン形式での分析ロジック追加
- カスタムスコア算出式
- 新しいチャート・可視化形式

### 3. 国際化対応
- 多言語サポートの準備
- 地域固有データソースの対応
- タイムゾーン・通貨形式の考慮

## デプロイメント・運用

### 1. 環境構成
- **開発環境**: Lovable開発環境
- **本番環境**: Lovable公開環境
- **データベース**: Supabase Postgres

### 2. 監視・ログ
- コンソールログによるデバッグ情報
- エラー追跡・通知
- パフォーマンス監視

### 3. バックアップ・復旧
- Supabaseによる自動バックアップ
- データエクスポート機能
- 災害復旧計画

## 今後の開発ロードマップ

### Phase 1: 基本機能完成
- [x] データソース統合
- [x] 基本分析機能
- [x] ダッシュボード
- [ ] 実データソース接続

### Phase 2: 高度な分析
- [ ] AI分析機能の強化
- [ ] リアルタイム監視
- [ ] 自動アラート機能

### Phase 3: ビジネス機能
- [ ] 営業CRM連携
- [ ] 請求書・契約書生成
- [ ] 顧客管理機能

## READMEとの関係

本仕様書は`README.md`の技術仕様を詳細化したものです。
- `README.md`: プロジェクト概要、セットアップ手順、基本機能説明
- `仕様・設計書.md`: 詳細仕様、アーキテクチャ、設計思想、拡張計画

両ドキュメントは相互補完的な関係にあり、開発者向けの技術情報は本書に、ユーザー向けの利用情報はREADMEに記載されています。
